{% extends 'base.html' %}
{% block content %}
<div class="community-list-container" style="max-width:1100px;margin:3.5rem auto 0 auto;">
  <h2 style="font-size:2.2rem;font-weight:900;color:#2d2013;margin-bottom:2.5rem;text-align:center;letter-spacing:1px;font-family:'Playfair Display',serif;">Community Posts</h2>
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:2.5rem;">
    {% with approved_posts=posts|dictsort:"is_approved"|slice:":" %}
      {% for post in posts %}
        {% if post.is_approved %}
          <div style="background:#fff;border-radius:1.5rem;box-shadow:0 8px 32px rgba(199,161,122,0.13);padding:2rem 1.5rem;display:flex;flex-direction:column;gap:1rem;align-items:flex-start;">
            <div style="display:flex;align-items:center;gap:0.7rem;margin-bottom:0.5rem;">
              <span style="background:#ffd700;color:#2d2013;font-weight:700;padding:0.3rem 1rem;border-radius:1rem;font-size:0.98rem;">{{ post.category.name }}</span>
            </div>
            <a href="{% url 'post_detail' post.pk %}" style="font-size:1.25rem;font-weight:800;color:#2d2013;text-decoration:none;">{{ post.title }}</a>
            <div style="color:#444;font-size:1.08rem;line-height:1.6;">{{ post.description|truncatewords:22 }}</div>
            {% if post.image %}
              <img src="{{ post.image.url }}" alt="Post Image" style="width:100%;max-width:220px;height:120px;object-fit:cover;border-radius:0.7rem;box-shadow:0 1px 6px #fffbe6;margin-top:0.5rem;">
            {% endif %}
            {% if user.is_authenticated %}
              <a href="{% url 'report_content' 'post' post.pk %}" style="color:#e53935;font-size:0.98rem;font-weight:600;margin-top:0.5rem;">Report</a>
            {% endif %}
          </div>
        {% endif %}
      {% empty %}
        <div style="color:#888;text-align:center;">No posts yet.</div>
      {% endfor %}
      {% if not posts or not posts|dictsort:"is_approved" %}
        <div style="color:#888;text-align:center;">No posts yet.</div>
      {% endif %}
    {% endwith %}
  </div>
  <h3 style="margin-top:3rem;font-size:1.2rem;color:#a67c52;font-weight:700;">Categories</h3>
  <div style="display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem;">
    {% for category in categories %}
      <span style="background:#f8f6f3;color:#a67c52;font-weight:600;padding:0.5rem 1.2rem;border-radius:1.2rem;font-size:1.05rem;">{{ category.name }}</span>
    {% endfor %}
  </div>
</div>
{% endblock %}