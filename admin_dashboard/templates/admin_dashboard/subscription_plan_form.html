{% extends 'admin_dashboard/base_admin.html' %}
{% load static %}

{% block title %}{{ page_title }}{% endblock %}
{% block page_title %}{{ page_title }}{% endblock %}

{% block extra_css %}
<style>
    .form-section {
        background: white;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(45, 32, 19, 0.1);
        margin-bottom: 20px;
        overflow: hidden;
    }
    
    .form-section-header {
        background: linear-gradient(135deg, var(--chocolate-dark), var(--chocolate-medium));
        color: white;
        padding: 15px 20px;
        border-bottom: 3px solid var(--gold);
    }
    
    .form-section-header h6 {
        margin: 0;
        font-weight: bold;
        color: var(--gold);
    }
    
    .form-section-body {
        padding: 20px;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    .form-label {
        font-weight: 600;
        color: var(--chocolate-dark);
        margin-bottom: 8px;
        display: block;
    }
    
    .form-control {
        border: 2px solid rgba(212, 175, 55, 0.3);
        border-radius: 6px;
        padding: 10px 12px;
        transition: all 0.3s ease;
    }
    
    .form-control:focus {
        border-color: var(--gold);
        box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        outline: none;
    }
    
    .form-check-input {
        border: 2px solid rgba(212, 175, 55, 0.5);
        border-radius: 4px;
    }
    
    .form-check-input:checked {
        background-color: var(--gold);
        border-color: var(--gold);
    }
    
    .help-text {
        font-size: 12px;
        color: #666;
        margin-top: 5px;
    }
    
    .btn-primary {
        background: linear-gradient(135deg, var(--chocolate-dark), var(--chocolate-medium));
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: bold;
        transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
        background: linear-gradient(135deg, var(--chocolate-medium), var(--gold));
        color: var(--chocolate-dark);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    
    .btn-secondary {
        background: #6c757d;
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: bold;
        text-decoration: none;
        display: inline-block;
        transition: all 0.3s ease;
    }
    
    .btn-secondary:hover {
        background: #5a6268;
        color: white;
        text-decoration: none;
        transform: translateY(-2px);
    }
    
    .unlimited-badge {
        background: var(--gold);
        color: var(--chocolate-dark);
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 11px;
        font-weight: bold;
        margin-left: 8px;
    }
    
    .required-field {
        color: #dc3545;
    }
</style>
{% endblock %}

{% block content %}
<!-- Header Section -->
<div class="row mb-4">
    <div class="col-12">
        <div class="form-section">
            <div class="form-section-header">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h4 class="mb-2" style="color: var(--gold); font-weight: bold;">
                            <i class="fas fa-{% if action == 'Add' %}plus{% else %}edit{% endif %} me-2"></i>
                            {{ page_title }}
                        </h4>
                        <p class="mb-0" style="color: white; opacity: 0.9;">
                            {% if action == 'Add' %}
                                Create a new subscription plan with custom pricing and features
                            {% else %}
                                Update subscription plan details, pricing, and feature settings
                            {% endif %}
                        </p>
                    </div>
                    <a href="{% url 'admin_dashboard:subscription_plans' %}" class="btn btn-sm" style="background: var(--gold); color: var(--chocolate-dark); border: none; font-weight: bold; padding: 8px 16px; border-radius: 6px;">
                        <i class="fas fa-arrow-left me-1"></i> Back to Plans
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<form method="post">
    {% csrf_token %}
    
    <div class="row">
        <!-- Basic Information -->
        <div class="col-md-6">
            <div class="form-section">
                <div class="form-section-header">
                    <h6><i class="fas fa-info-circle me-2"></i>Basic Information</h6>
                </div>
                <div class="form-section-body">
                    <div class="form-group">
                        <label for="{{ form.name.id_for_label }}" class="form-label">
                            Plan Type <span class="required-field">*</span>
                        </label>
                        {{ form.name }}
                        {% if form.name.errors %}
                            <div class="text-danger">{{ form.name.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.display_name.id_for_label }}" class="form-label">
                            Display Name <span class="required-field">*</span>
                        </label>
                        {{ form.display_name }}
                        {% if form.display_name.errors %}
                            <div class="text-danger">{{ form.display_name.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.features_description.id_for_label }}" class="form-label">
                            Features Description
                        </label>
                        {{ form.features_description }}
                        <div class="help-text">Enter key features, one per line using bullet points (â€¢)</div>
                        {% if form.features_description.errors %}
                            <div class="text-danger">{{ form.features_description.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <div class="form-check">
                            {{ form.is_active }}
                            <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
                                Plan is Active
                            </label>
                        </div>
                        {% if form.is_active.errors %}
                            <div class="text-danger">{{ form.is_active.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Pricing -->
        <div class="col-md-6">
            <div class="form-section">
                <div class="form-section-header">
                    <h6><i class="fas fa-dollar-sign me-2"></i>Pricing & Commission</h6>
                </div>
                <div class="form-section-body">
                    <div class="form-group">
                        <label for="{{ form.price_monthly.id_for_label }}" class="form-label">
                            Monthly Price (RWF) <span class="required-field">*</span>
                        </label>
                        {{ form.price_monthly }}
                        {% if form.price_monthly.errors %}
                            <div class="text-danger">{{ form.price_monthly.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.price_yearly.id_for_label }}" class="form-label">
                            Yearly Price (RWF)
                        </label>
                        {{ form.price_yearly }}
                        <div class="help-text">Leave empty to auto-calculate (10 months pricing)</div>
                        {% if form.price_yearly.errors %}
                            <div class="text-danger">{{ form.price_yearly.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.commission_rate.id_for_label }}" class="form-label">
                            Commission Rate (%)
                        </label>
                        {{ form.commission_rate }}
                        <div class="help-text">{{ form.commission_rate.help_text }}</div>
                        {% if form.commission_rate.errors %}
                            <div class="text-danger">{{ form.commission_rate.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.currency.id_for_label }}" class="form-label">
                            Currency
                        </label>
                        {{ form.currency }}
                        {% if form.currency.errors %}
                            <div class="text-danger">{{ form.currency.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- Usage Limits -->
        <div class="col-md-6">
            <div class="form-section">
                <div class="form-section-header">
                    <h6><i class="fas fa-sliders-h me-2"></i>Usage Limits</h6>
                </div>
                <div class="form-section-body">
                    <div class="form-group">
                        <label for="{{ form.max_photos_upload.id_for_label }}" class="form-label">
                            Max Photos per Month
                            <span class="unlimited-badge">-1 = Unlimited</span>
                        </label>
                        {{ form.max_photos_upload }}
                        <div class="help-text">{{ form.max_photos_upload.help_text }}</div>
                        {% if form.max_photos_upload.errors %}
                            <div class="text-danger">{{ form.max_photos_upload.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.max_storage_gb.id_for_label }}" class="form-label">
                            Storage Limit (GB)
                            <span class="unlimited-badge">-1 = Unlimited</span>
                        </label>
                        {{ form.max_storage_gb }}
                        <div class="help-text">{{ form.max_storage_gb.help_text }}</div>
                        {% if form.max_storage_gb.errors %}
                            <div class="text-danger">{{ form.max_storage_gb.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.max_bookings_per_month.id_for_label }}" class="form-label">
                            Max Bookings per Month
                            <span class="unlimited-badge">-1 = Unlimited</span>
                        </label>
                        {{ form.max_bookings_per_month }}
                        <div class="help-text">{{ form.max_bookings_per_month.help_text }}</div>
                        {% if form.max_bookings_per_month.errors %}
                            <div class="text-danger">{{ form.max_bookings_per_month.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.max_portfolio_items.id_for_label }}" class="form-label">
                            Max Portfolio Items
                            <span class="unlimited-badge">-1 = Unlimited</span>
                        </label>
                        {{ form.max_portfolio_items }}
                        <div class="help-text">{{ form.max_portfolio_items.help_text }}</div>
                        {% if form.max_portfolio_items.errors %}
                            <div class="text-danger">{{ form.max_portfolio_items.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Support & Features -->
        <div class="col-md-6">
            <div class="form-section">
                <div class="form-section-header">
                    <h6><i class="fas fa-star me-2"></i>Support & Features</h6>
                </div>
                <div class="form-section-body">
                    <div class="form-group">
                        <label for="{{ form.support_level.id_for_label }}" class="form-label">
                            Support Level
                        </label>
                        {{ form.support_level }}
                        {% if form.support_level.errors %}
                            <div class="text-danger">{{ form.support_level.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.customization_level.id_for_label }}" class="form-label">
                            Customization Level
                        </label>
                        {{ form.customization_level }}
                        {% if form.customization_level.errors %}
                            <div class="text-danger">{{ form.customization_level.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.additional_services.id_for_label }}" class="form-label">
                            Additional Services
                        </label>
                        {{ form.additional_services }}
                        {% if form.additional_services.errors %}
                            <div class="text-danger">{{ form.additional_services.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <!-- Feature Checkboxes -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check mb-3">
                                {{ form.priority_support }}
                                <label class="form-check-label" for="{{ form.priority_support.id_for_label }}">
                                    Priority Support
                                </label>
                            </div>
                            
                            <div class="form-check mb-3">
                                {{ form.analytics_access }}
                                <label class="form-check-label" for="{{ form.analytics_access.id_for_label }}">
                                    Analytics Access
                                </label>
                            </div>
                            
                            <div class="form-check mb-3">
                                {{ form.api_access }}
                                <label class="form-check-label" for="{{ form.api_access.id_for_label }}">
                                    API Access
                                </label>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-check mb-3">
                                {{ form.includes_premium_support }}
                                <label class="form-check-label" for="{{ form.includes_premium_support.id_for_label }}">
                                    Premium Support
                                </label>
                            </div>
                            
                            <div class="form-check mb-3">
                                {{ form.includes_consulting }}
                                <label class="form-check-label" for="{{ form.includes_consulting.id_for_label }}">
                                    Consulting Sessions
                                </label>
                            </div>
                            
                            <div class="form-check mb-3">
                                {{ form.includes_add_ons }}
                                <label class="form-check-label" for="{{ form.includes_add_ons.id_for_label }}">
                                    Add-ons Included
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Form Actions -->
    <div class="row">
        <div class="col-12">
            <div class="form-section">
                <div class="form-section-body text-center">
                    <button type="submit" class="btn btn-primary me-3">
                        <i class="fas fa-{% if action == 'Add' %}plus{% else %}save{% endif %} me-2"></i>
                        {{ action }} Subscription Plan
                    </button>
                    <a href="{% url 'admin_dashboard:subscription_plans' %}" class="btn btn-secondary">
                        <i class="fas fa-times me-2"></i>
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div>
</form>
{% endblock %}