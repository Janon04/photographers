{% extends 'base.html' %}
{% block content %}
<div class="container" style="max-width:800px;margin:2rem auto;">
  <h2 style="font-size:2rem;font-weight:800;color:#2d2013;margin-bottom:1.2rem;">{{ post.title }}</h2>
  <div style="color:#6b6b6b;font-size:1rem;margin-bottom:0.7rem;">
  By {{ post.owner.get_full_name|default:post.owner.username }} on {{ post.created_at|date:'M d, Y' }}
    {% if post.category %} | <span style="color:#a67c52;">{{ post.category.name }}</span>{% endif %}
    {% if post.tags.all %}
      | <span style="color:#25D366;">{% for tag in post.tags.all %}{{ tag.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</span>
    {% endif %}
  </div>
  {% if post.image %}
    <img src="{{ post.image.url }}" alt="{{ post.title }}" style="max-width:100%;height:auto;border-radius:0.7rem;margin-bottom:1.2rem;">
  {% endif %}
  <div style="color:#444;font-size:1.13rem;line-height:1.7;">{{ post.content|linebreaks }}</div>
  {% if user.is_authenticated and user == post.owner %}
    <a href="{% url 'blog_edit' post.pk %}" class="btn btn-outline" style="margin-top:1.2rem;">Edit Article</a>
  {% endif %}
  <a href="{% url 'blog_list' %}" style="color:#a67c52;font-weight:600;display:block;margin-top:2rem;">‚Üê Back to Blog</a>
  <hr style="margin:2rem 0;">
  <h4 style="color:#c7a17a;font-weight:700;margin-bottom:1rem;">Comments</h4>
  <div>
    {% for comment in comments %}
      <div style="background:#f8f6f3;border-radius:0.7rem;padding:0.7rem 1rem;margin-bottom:0.7rem;">
  <b style="color:#2d2013;">
    {% if comment.author %}
      {{ comment.author.get_full_name|default:comment.author.username }}
    {% else %}
      {{ comment.name|default:"Anonymous" }}
      {% if comment.email %}<span style="color:#888;font-size:0.9rem;"> ({{ comment.email }})</span>{% endif %}
    {% endif %}
        <span style="color:#888;font-size:0.95rem;">{{ comment.created_at|date:'M d, Y H:i' }}</span><br>
        <span style="color:#444;">{{ comment.text|linebreaks }}</span>
      </div>
    {% empty %}
      <div style="color:#aaa;">No comments yet.</div>
    {% endfor %}
  </div>
  <form method="post" style="margin-top:1.2rem;">
    {% csrf_token %}
    {{ comment_form.as_p }}
    <button type="submit" class="btn btn-primary">Add Comment</button>
  </form>
</div>
{% endblock %}
