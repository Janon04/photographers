{% extends 'base.html' %}
{% load static %}
{% block content %}

<!-- Success/Error Messages -->
{% if messages %}
  {% for message in messages %}
    <div id="messagePopup" class="message-popup {{ message.tags }}" style="
      position: fixed;
      top: 20px;
      right: 20px;
      background: {% if message.tags == 'success' %}#d4edda{% else %}#f8d7da{% endif %};
      color: {% if message.tags == 'success' %}#155724{% else %}#721c24{% endif %};
      border: 1px solid {% if message.tags == 'success' %}#c3e6cb{% else %}#f5c6cb{% endif %};
      border-radius: 0.5rem;
      padding: 1rem 1.5rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      z-index: 9999;
      max-width: 400px;
      animation: slideIn 0.3s ease-out;
    ">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <span style="font-size: 1.2rem;">
          {% if message.tags == 'success' %}âœ…{% else %}âŒ{% endif %}
        </span>
        <span style="font-weight: 500;">{{ message }}</span>
        <button onclick="closePopup()" style="
          background: none;
          border: none;
          font-size: 1.2rem;
          cursor: pointer;
          margin-left: auto;
          color: inherit;
        ">âœ•</button>
      </div>
    </div>
  {% endfor %}
{% endif %}

{% if error_message %}
  <div id="errorPopup" class="message-popup error" style="
    position: fixed;
    top: 20px;
    right: 20px;
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
    border-radius: 0.5rem;
    padding: 1rem 1.5rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    z-index: 9999;
    max-width: 400px;
    animation: slideIn 0.3s ease-out;
  ">
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <span style="font-size: 1.2rem;">âŒ</span>
      <span style="font-weight: 500;">{{ error_message }}</span>
      <button onclick="closeErrorPopup()" style="
        background: none;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
        margin-left: auto;
        color: inherit;
      ">âœ•</button>
    </div>
  </div>
{% endif %}

<div class="contact-container" style="max-width:600px;margin:2rem auto;padding:2rem;background:#fffbe6;border-radius:1.2rem;box-shadow:0 2px 8px rgba(199,161,122,0.07);">
  <h1 style="text-align: center; color: #a67c52; margin-bottom: 1.5rem;">ğŸ“ Contact Us</h1>
  <p style="text-align: center; color: #6c5430; margin-bottom: 2rem;">We'd love to hear from you! Send us a message and we'll respond as soon as possible.</p>
  
  <form method="post" action="" id="contactForm" onsubmit="return handleSubmit(event)">
    {% csrf_token %}
    <div style="margin-bottom:1.2rem;">
      <label for="name" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #6c5430;">Name:</label>
      <input type="text" id="name" name="name" required style="width:100%;padding:0.7em;border-radius:0.5em;border:1px solid #c7a17a;font-size:1rem;transition:border-color 0.3s;" onfocus="this.style.borderColor='#a67c52'" onblur="this.style.borderColor='#c7a17a'">
    </div>
    <div style="margin-bottom:1.2rem;">
      <label for="email" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #6c5430;">Email:</label>
      <input type="email" id="email" name="email" required style="width:100%;padding:0.7em;border-radius:0.5em;border:1px solid #c7a17a;font-size:1rem;transition:border-color 0.3s;" onfocus="this.style.borderColor='#a67c52'" onblur="this.style.borderColor='#c7a17a'">
    </div>
    <div style="margin-bottom:1.2rem;">
      <label for="message" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #6c5430;">Message:</label>
      <textarea id="message" name="message" rows="5" required style="width:100%;padding:0.7em;border-radius:0.5em;border:1px solid #c7a17a;font-size:1rem;resize:vertical;transition:border-color 0.3s;" onfocus="this.style.borderColor='#a67c52'" onblur="this.style.borderColor='#c7a17a'" placeholder="Tell us how we can help you..."></textarea>
    </div>
    <button type="submit" id="submitBtn" style="
      background:#a67c52;
      color:#fff;
      padding:0.8em 2.5em;
      border:none;
      border-radius:0.7em;
      font-weight:600;
      cursor:pointer;
      font-size:1rem;
      transition:all 0.3s;
      display:block;
      margin:0 auto;
      position:relative;
    " 
    onmouseover="this.style.background='#8b6441'" 
    onmouseout="this.style.background='#a67c52'">
      <span id="btnText">ğŸ“§ Send Message</span>
      <span id="btnLoader" style="display:none;">
        <span style="display:inline-block;width:1rem;height:1rem;border:2px solid #fff;border-top:2px solid transparent;border-radius:50%;animation:spin 1s linear infinite;margin-right:0.5rem;"></span>
        Sending...
      </span>
    </button>
  </form>
</div>

<style>
@keyframes slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.message-popup {
  animation: slideIn 0.3s ease-out;
}
</style>

<script>
function handleSubmit(event) {
  const btn = document.getElementById('submitBtn');
  const btnText = document.getElementById('btnText');
  const btnLoader = document.getElementById('btnLoader');
  
  // Show loading state
  if (btnText && btnLoader && btn) {
    btnText.style.display = 'none';
    btnLoader.style.display = 'inline-block';
    btn.disabled = true;
    btn.style.cursor = 'not-allowed';
  }
  
  // Allow the form to submit normally
  return true;
}

function closePopup() {
  const popup = document.getElementById('messagePopup');
  if (popup) {
    popup.style.animation = 'slideOut 0.3s ease-in forwards';
    setTimeout(() => popup.remove(), 300);
  }
}

function closeErrorPopup() {
  const popup = document.getElementById('errorPopup');
  if (popup) {
    popup.style.animation = 'slideOut 0.3s ease-in forwards';
    setTimeout(() => popup.remove(), 300);
  }
}

// Auto-hide success/error messages after 5 seconds
setTimeout(() => {
  const popups = document.querySelectorAll('.message-popup');
  popups.forEach(popup => {
    popup.style.animation = 'slideOut 0.3s ease-in forwards';
    setTimeout(() => popup.remove(), 300);
  });
}, 5000);

// Add slideOut animation
const style = document.createElement('style');
style.textContent = `
  @keyframes slideOut {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }
`;
document.head.appendChild(style);
</script>

{% endblock %}
